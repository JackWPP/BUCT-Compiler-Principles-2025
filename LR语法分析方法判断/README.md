# LR语法分析方法判断程序

## 项目信息
- **课程**: 编译原理
- **作业**: 题目4.10 LR语法分析方法判断
- **作者**: 王海翔
- **学号**: 2021060187
- **班级**: 计科2203

## 功能概述

本程序实现了上下文无关文法的LR语法分析方法判断，包括：

1. **文法处理**
   - 上下文无关文法的识别和解析
   - 文法的拓广
   - FIRST集合和FOLLOW集合的计算

2. **自动机构建**
   - LR(0)识别活前缀的状态机构建
   - LR(1)识别活前缀的状态机构建
   - 状态转换图的生成

3. **LR方法判断**
   - LR(0)方法判断
   - SLR(1)方法判断
   - LR(1)方法判断
   - LALR(1)方法判断
   - 冲突检测和报告

4. **可视化功能**
   - 自动机状态转换图的可视化
   - 交互式状态查看
   - 图片导出功能

5. **用户界面**
   - 现代化的GUI界面
   - 多标签页设计
   - 文件加载和保存功能

## 安装和运行

### 环境要求
- Python 3.7+
- tkinter (通常随Python安装)
- matplotlib
- networkx
- numpy

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python lr_parser_gui.py
```

## 使用说明

### 1. 文法输入

在"文法输入"标签页中：

1. **输入文法格式**：
   ```
   左部 -> 右部1 | 右部2 | ...
   ```

2. **示例**：
   ```
   E -> E + T | T
   T -> T * F | F
   F -> ( E ) | id
   ```

3. **特殊符号**：
   - 空串：`ε` 或 `epsilon`
   - 终结符：小写字母、符号
   - 非终结符：大写字母开头

4. **设置开始符号**：在开始符号输入框中指定

5. **点击"解析文法"**：解析并显示文法信息

### 2. LR分析

在"LR分析"标签页中：

1. **执行分析**：点击"执行LR分析"按钮
2. **查看结果**：
   - LR类型判断结果表格
   - 冲突详情
   - 自动机状态列表
3. **状态详情**：点击状态列表中的项目查看详细信息

### 3. 可视化

在"自动机可视化"标签页中：

1. **选择自动机类型**：LR(0) 或 LR(1)
2. **生成可视化**：点击"生成可视化"按钮
3. **保存图片**：点击"保存图片"按钮导出

### 4. 文件操作

- **加载文法文件**：Ctrl+O 或点击"加载文件"按钮
- **保存文法**：点击"保存文法"按钮
- **保存分析结果**：Ctrl+S 或点击"保存结果"按钮

## 快捷键

- `Ctrl+O`：加载文法文件
- `Ctrl+S`：保存分析结果
- `F5`：执行LR分析
- `Ctrl+L`：清空输入

## 文件结构

```
LR语法分析方法判断/
├── lr_parser_gui.py          # 主程序文件
├── requirements.txt          # 依赖包列表
├── sample_input.txt          # 示例输入文法
├── README.md                 # 说明文档
└── 作业要求.md               # 作业要求
```

## 核心算法

### 1. 文法拓广
- 为原文法添加新的开始符号
- 创建拓广产生式 S' -> S

### 2. FIRST集合计算
- 迭代算法计算每个符号的FIRST集合
- 处理空产生式的情况

### 3. FOLLOW集合计算
- 基于FIRST集合计算FOLLOW集合
- 处理产生式右部的符号串

### 4. LR(0)自动机构建
- 项目集闭包计算
- GOTO函数实现
- 状态转换图构建

### 5. LR(1)自动机构建
- 带向前看符号的项目集
- 扩展的闭包计算
- 更精确的冲突检测

### 6. 冲突检测
- **LR(0)**：检查移进-归约和归约-归约冲突
- **SLR(1)**：使用FOLLOW集合解决冲突
- **LR(1)**：使用向前看符号精确检测
- **LALR(1)**：合并同心状态后检测

## 测试用例

程序包含多个测试文法：

1. **简单算术表达式**：LR(0)冲突，SLR(1)可行
2. **复杂文法**：需要LR(1)才能解析
3. **简单LR(0)文法**：无冲突
4. **含空产生式文法**：测试空产生式处理

## 技术特点

1. **模块化设计**：清晰的类结构和职责分离
2. **完整注释**：详细的中文注释说明
3. **错误处理**：完善的异常处理机制
4. **用户友好**：直观的GUI界面和操作提示
5. **可扩展性**：便于后续SLR(1)完整语法分析的复用

## 输出说明

### 分析结果包含：
1. **文法信息**：产生式、终结符、非终结符
2. **FIRST/FOLLOW集合**：各符号的集合
3. **LR类型判断**：四种LR方法的判断结果
4. **冲突详情**：具体的冲突位置和类型
5. **自动机状态**：所有状态的项目集
6. **状态转换**：状态间的转换关系

## 注意事项

1. **文法格式**：严格按照指定格式输入
2. **符号约定**：区分终结符和非终结符
3. **性能考虑**：大型文法的可视化可能较慢
4. **编码支持**：支持UTF-8编码的文本文件

## 后续扩展

本程序设计时考虑了与后续SLR(1)完整语法分析程序的兼容性：

1. **Grammar类**：可直接复用于语法分析
2. **LRAutomaton类**：提供状态机基础
3. **LRAnalyzer类**：可扩展为完整的分析器
4. **GUI框架**：可复用界面设计模式

## 联系信息

如有问题或建议，请联系：
- 作者：王海翔
- 学号：2021060187
- 班级：计科2203