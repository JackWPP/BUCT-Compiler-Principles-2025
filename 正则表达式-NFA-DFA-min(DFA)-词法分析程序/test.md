# 词法分析程序测试文档

## 测试概述
本文档包含了词法分析程序的完整测试用例，涵盖正则表达式转NFA、NFA转DFA、DFA最小化和词法分析等核心功能。

---

## 1. 正则表达式转NFA测试

### 测试用例1.1：基本字符
**输入正则表达式：** `a`
**预期结果：** 生成包含2个状态的NFA，接受字符串"a"
**测试步骤：**
1. 运行程序选择选项1
2. 输入正则表达式"a"
3. 验证生成的NFA状态数量
4. 验证NFA能正确识别"a"

### 测试用例1.2：连接操作
**输入正则表达式：** `ab`
**预期结果：** 生成NFA，接受字符串"ab"
**测试步骤：**
1. 输入正则表达式"ab"
2. 验证NFA状态转换正确
3. 测试字符串"ab"、"a"、"b"、"ba"

### 测试用例1.3：选择操作
**输入正则表达式：** `a|b`
**预期结果：** 生成NFA，接受字符串"a"或"b"
**测试步骤：**
1. 输入正则表达式"a|b"
2. 验证NFA能接受"a"
3. 验证NFA能接受"b"
4. 验证NFA不接受"ab"或"c"

### 测试用例1.4：Kleene闭包
**输入正则表达式：** `a*`
**预期结果：** 生成NFA，接受空串、"a"、"aa"、"aaa"等
**测试步骤：**
1. 输入正则表达式"a*"
2. 测试空字符串""
3. 测试"a"、"aa"、"aaa"
4. 验证不接受"b"或"ab"

### 测试用例1.5：复杂表达式
**输入正则表达式：** `(a|b)*abb`
**预期结果：** 生成NFA，接受以"abb"结尾的由a和b组成的字符串
**测试步骤：**
1. 输入正则表达式"(a|b)*abb"
2. 测试"abb"、"aabb"、"babb"、"ababb"
3. 验证不接受"ab"、"ba"、"abba"

---

## 2. NFA转DFA测试

### 测试用例2.1：简单NFA转换
**输入：** 从正则表达式"a|b"生成的NFA
**预期结果：** 生成等价的DFA，状态数量减少
**测试步骤：**
1. 先生成NFA
2. 执行NFA到DFA转换
3. 验证DFA状态数量
4. 验证DFA功能等价性

### 测试用例2.2：包含ε转换的NFA
**输入：** 从正则表达式"a*"生成的NFA
**预期结果：** 正确处理ε转换，生成确定性DFA
**测试步骤：**
1. 生成包含ε转换的NFA
2. 执行子集构造算法
3. 验证所有ε转换被正确处理
4. 测试相同的输入字符串

### 测试用例2.3：复杂NFA转换
**输入：** 从正则表达式"(a|b)*abb"生成的NFA
**预期结果：** 生成优化的DFA
**测试步骤：**
1. 转换复杂NFA
2. 比较转换前后的状态数量
3. 验证接受相同的语言

---

## 3. DFA最小化测试

### 测试用例3.1：可最小化的DFA
**输入：** 包含等价状态的DFA
**预期结果：** 合并等价状态，减少状态数量
**测试步骤：**
1. 使用包含冗余状态的DFA
2. 执行最小化算法
3. 验证状态数量减少
4. 验证功能保持不变

### 测试用例3.2：已最小的DFA
**输入：** 已经最小化的DFA
**预期结果：** 状态数量不变
**测试步骤：**
1. 使用最小DFA
2. 执行最小化
3. 验证状态数量不变

### 测试用例3.3：复杂DFA最小化
**输入：** 从"(a|b)*abb"转换的DFA
**预期结果：** 生成最小等价DFA
**测试步骤：**
1. 对复杂DFA执行最小化
2. 验证结果DFA的正确性
3. 确认无法进一步最小化

---

## 4. 词法分析测试

### 测试用例4.1：Pascal关键字识别
**输入代码：**
```pascal
program test;
begin
  var x: integer;
  if x > 0 then
    writeln('positive');
end.
```
**预期结果：** 正确识别所有关键字、标识符、运算符
**测试步骤：**
1. 输入Pascal代码
2. 执行词法分析
3. 验证token类型正确
4. 检查token位置信息

### 测试用例4.2：数字字面量
**输入代码：**
```pascal
var a := 123;
var b := 45.67;
var c := 0;
```
**预期结果：** 正确识别整数和浮点数
**测试步骤：**
1. 分析包含各种数字的代码
2. 验证数字token的值
3. 检查数字类型识别

### 测试用例4.3：字符串字面量
**输入代码：**
```pascal
var msg := 'Hello World';
var empty := '';
var quote := 'It\'s a test';
```
**预期结果：** 正确处理字符串，包括转义字符
**测试步骤：**
1. 分析包含字符串的代码
2. 验证字符串内容正确
3. 检查转义字符处理

### 测试用例4.4：注释处理
**输入代码：**
```pascal
// 单行注释
var x: integer; // 行尾注释
/* 多行注释
   跨越多行 */
var y: real;
```
**预期结果：** 正确跳过注释，不生成token
**测试步骤：**
1. 分析包含注释的代码
2. 验证注释被忽略
3. 确认注释后的代码正常解析

### 测试用例4.5：运算符和分隔符
**输入代码：**
```pascal
result := (a + b) * c - d / e;
if (x >= y) and (z <= w) then
  flag := true;
```
**预期结果：** 正确识别所有运算符和分隔符
**测试步骤：**
1. 分析包含各种运算符的代码
2. 验证运算符token类型
3. 检查优先级信息

### 测试用例4.6：错误处理
**输入代码：**
```pascal
var x := 123abc;  // 无效数字
var y := 'unclosed string;
var z := @invalid;
```
**预期结果：** 正确报告词法错误
**测试步骤：**
1. 输入包含错误的代码
2. 验证错误被检测
3. 检查错误位置准确性
4. 确认错误恢复机制

---

## 5. 完整流程测试

### 测试用例5.1：端到端测试
**测试目标：** 验证从正则表达式到词法分析的完整流程
**测试步骤：**
1. 定义词法规则的正则表达式
2. 转换为NFA
3. 转换为DFA
4. 最小化DFA
5. 使用最终DFA进行词法分析
6. 验证整个流程的正确性

### 测试用例5.2：性能测试
**测试目标：** 验证程序在处理大型输入时的性能
**测试步骤：**
1. 准备大型源代码文件
2. 测量词法分析时间
3. 监控内存使用
4. 验证结果正确性

---

## 6. 边界条件测试

### 测试用例6.1：空输入
**输入：** 空字符串
**预期结果：** 程序正常处理，不崩溃

### 测试用例6.2：单字符输入
**输入：** 单个字符
**预期结果：** 正确识别或报告错误

### 测试用例6.3：超长输入
**输入：** 非常长的字符串
**预期结果：** 程序能够处理，不出现内存问题

### 测试用例6.4：特殊字符
**输入：** 包含Unicode字符、控制字符等
**预期结果：** 正确处理或给出适当错误信息

---

## 7. 配置文件测试

### 测试用例7.1：加载词法规则文件
**输入：** 自定义的lexical_rules.txt文件
**预期结果：** 正确加载并应用规则
**测试步骤：**
1. 创建自定义规则文件
2. 加载规则文件
3. 验证规则生效
4. 测试词法分析结果

### 测试用例7.2：无效规则文件
**输入：** 格式错误的规则文件
**预期结果：** 给出清晰的错误信息
**测试步骤：**
1. 创建格式错误的文件
2. 尝试加载
3. 验证错误处理

---

## 8. 用户界面测试

### 测试用例8.1：菜单导航
**测试目标：** 验证所有菜单选项正常工作
**测试步骤：**
1. 测试每个菜单选项
2. 验证输入验证
3. 检查返回主菜单功能

### 测试用例8.2：帮助功能
**测试目标：** 验证帮助信息完整准确
**测试步骤：**
1. 选择帮助选项
2. 验证信息完整性
3. 检查格式正确性

---

## 9. 回归测试

### 测试用例9.1：已知问题验证
**测试目标：** 确保之前修复的问题不再出现
**测试步骤：**
1. 重现之前的问题场景
2. 验证问题已解决
3. 确认修复没有引入新问题

---

## 10. 测试执行指南

### 自动化测试脚本
```batch
@echo off
echo 开始执行词法分析程序测试...

:: 测试1：基本功能
echo 测试正则表达式转NFA...
词法分析程序.exe < test_input_1.txt > test_output_1.txt

:: 测试2：词法分析
echo 测试词法分析功能...
词法分析程序.exe < test_input_2.txt > test_output_2.txt

:: 比较结果
echo 比较测试结果...
fc test_output_1.txt expected_output_1.txt
fc test_output_2.txt expected_output_2.txt

echo 测试完成！
pause
```

### 测试数据文件
- `test_input_1.txt` - 正则表达式测试输入
- `test_input_2.txt` - 词法分析测试输入
- `expected_output_1.txt` - 预期输出1
- `expected_output_2.txt` - 预期输出2

### 测试报告模板
```
测试日期：[日期]
测试版本：[版本号]
测试环境：[操作系统和环境信息]

测试结果汇总：
- 通过测试：[数量]
- 失败测试：[数量]
- 跳过测试：[数量]

详细结果：
[具体测试用例结果]

问题和建议：
[发现的问题和改进建议]
```

---

## 注意事项

1. **测试环境准备**：确保程序能正常运行
2. **数据备份**：测试前备份重要数据
3. **结果记录**：详细记录每个测试的结果
4. **问题跟踪**：及时记录和跟踪发现的问题
5. **版本控制**：确保测试的是正确版本的程序

---

## 测试清单

- [ ] 正则表达式转NFA测试
- [ ] NFA转DFA测试
- [ ] DFA最小化测试
- [ ] 词法分析功能测试
- [ ] 错误处理测试
- [ ] 边界条件测试
- [ ] 性能测试
- [ ] 用户界面测试
- [ ] 配置文件测试
- [ ] 回归测试

完成所有测试后，程序应该能够稳定、正确地执行所有预期功能。