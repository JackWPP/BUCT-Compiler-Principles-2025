# 依赖图语义分析程序

## 项目简介

本项目实现了基于依赖图的语义分析方法，是编译原理课程的作业项目。程序能够解析属性文法，构建属性依赖图，检测循环依赖，执行拓扑排序，并进行语义分析。

**作者信息：**
- 姓名：王海翔
- 学号：2021060187
- 班级：计科2203

## 主要功能

1. **属性文法解析** - 解析包含文法、属性定义和语义规则的属性文法
2. **依赖图构建** - 根据语法分析结果构建属性依赖图
3. **循环依赖检测** - 检测依赖图中的循环依赖并报告
4. **拓扑排序** - 对依赖图进行拓扑排序，确定属性计算顺序
5. **语义分析** - 基于依赖图执行语义分析过程
6. **可视化展示** - 图形化显示依赖图结构
7. **GUI界面** - 提供友好的图形用户界面

## 技术特点

- **完整的依赖图算法实现**：包括图构建、循环检测、拓扑排序等核心算法
- **支持多种属性类型**：综合属性和继承属性
- **智能错误检测**：自动检测循环依赖和其他错误
- **可视化支持**：使用NetworkX和Matplotlib进行图形化展示
- **中文界面**：全中文用户界面和文档
- **模块化设计**：清晰的代码结构和良好的可扩展性

## 系统要求

- Python 3.7+
- Windows 7/8/10/11（推荐）
- 内存：至少512MB
- 磁盘空间：至少100MB

## 依赖包

```
matplotlib>=3.5.0    # 图形绘制
networkx>=2.6.0      # 图算法
numpy>=1.21.0        # 数值计算
pyinstaller>=4.5.0   # 打包工具（可选）
```

## 安装和运行

### 方式一：直接运行Python程序

1. 克隆或下载项目代码
2. 安装依赖包：
   ```bash
   pip install -r requirements.txt
   ```
3. 运行程序：
   ```bash
   python dependency_graph_main.py
   ```

### 方式二：运行可执行文件

1. 下载发布包
2. 解压到任意目录
3. 双击"依赖图语义分析器.exe"或运行启动脚本

### 方式三：自行打包

1. 安装PyInstaller：
   ```bash
   pip install pyinstaller
   ```
2. 运行打包脚本：
   ```bash
   python build_exe.py
   ```

## 使用说明

### 1. 属性文法输入

在"属性文法输入"标签页中输入属性文法，格式如下：

```
[文法]
E -> E + T | T
T -> T * F | F
F -> ( E ) | id

[属性定义]
E.val : 综合属性
T.val : 综合属性
F.val : 综合属性
id.lexval : 综合属性

[语义规则]
E.val := E.val + T.val  # 0
E.val := T.val          # 1
T.val := T.val * F.val  # 2
T.val := F.val          # 3
F.val := E.val          # 4
F.val := id.lexval      # 5
```

### 2. 依赖图构建

1. 在"依赖图构建"标签页中输入语法分析结果（产生式编号序列）
2. 点击"构建依赖图"按钮
3. 查看依赖图信息和节点关系

### 3. 语义分析

1. 在"语义分析过程"标签页中输入待分析的字符串
2. 点击"执行语义分析"按钮
3. 查看详细的分析步骤和结果

### 4. 可视化

1. 在"依赖图可视化"标签页中点击"显示依赖图"
2. 查看图形化的依赖关系
3. 可保存图片到本地

## 文件结构

```
依赖图语义分析程序/
├── dependency_graph_main.py    # 主程序文件
├── requirements.txt            # 依赖包列表
├── sample_grammar.txt          # 示例文法
├── test_cases.txt             # 测试用例
├── build_exe.py               # 打包脚本
├── README.md                  # 项目说明
└── 发布包/                    # 发布文件（打包后生成）
    ├── 依赖图语义分析器.exe
    ├── 使用说明.txt
    ├── 发布说明.txt
    └── 启动依赖图语义分析器.bat
```

## 核心算法

### 1. 依赖图构建算法

根据属性文法和语法分析树构建属性依赖图：
- 为每个属性实例创建节点
- 根据语义规则建立依赖边
- 处理综合属性和继承属性的不同特性

### 2. 循环依赖检测

使用深度优先搜索（DFS）检测图中的循环：
- 三色标记法（白色、灰色、黑色）
- 检测后向边以发现循环
- 报告完整的循环路径

### 3. 拓扑排序

使用Kahn算法进行拓扑排序：
- 计算每个节点的入度
- 逐步移除入度为0的节点
- 生成属性计算的正确顺序

## 测试用例

项目包含多个测试用例，涵盖：
- 简单算术表达式
- 复杂嵌套表达式
- 错误输入处理
- 边界情况测试

运行测试：
```bash
python -m pytest test_dependency_graph.py
```

## 技术支持

如遇到问题，请检查：
1. Python版本是否符合要求
2. 依赖包是否正确安装
3. 文法格式是否正确
4. 语法分析结果是否有效

## 联系方式

- 作者：王海翔
- 学号：2021060187
- 班级：计科2203

## 许可证

本项目仅用于学习和教学目的。
